{"version":3,"sources":["script.js"],"names":["URL","CHECKINS_URL","quoteeUrl","start_date","end_date","async","fetchDates","url","target","btn_text","innerText","response","await","fetch","ok","json","Error","status","error","console","log","precessDates","data","let","item","enable_dates","enable_dates_obj","i","_embedded","hotel_availabilities","date","showMonthsVar","window","innerWidt","flatpickr","dateFormat","closeOnSelect","mode","showMonths","enable","onDayCreate","dObj","dStr","fp","dayElem","day","formattedDate","Intl","DateTimeFormat","format","dateObj","innerHTML","price","onOpen","selectedDates","dateStr","instance","calendar_container","calendarContainer","wrapper","document","createElement","apply_button","id","parentNode","insertBefore","appendChild","textContent","className","addEventListener","close","input_dates","input","value","displayRooms","split","onClose","getElementById","remove","open","createCalendar","fetchRooms","section_rooms","roomCard","message","room_card","querySelectorAll","hotel_quotes","forEach","element","classList","rooms","map","room","index","suspens_block_classname","suspens_line_classname","description","img","amenitie","nights","full_formatted_price","fullPriceBreakdown","pictures","offer_teaser_ncol","amenities","reduce","btn","onclick","event"],"mappings":"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","file":"all.min.js","sourcesContent":["\"use strict\";\r\n\r\nconst URL = \"https://api.travelcircus.net/hotels/17080/\";\r\n\r\nconst CHECKINS_URL = `${URL}checkins?E&party=%7B%22adults%22:2,%22childre\r\nn%22:%5B%5D%7D&domain=de&date_start=2025-01-01&date_end=2025-06-31`;\r\n\r\nfunction quoteeUrl(start_date, end_date) {\r\n  return `${URL}quotes?locale=de_DE&checkin=${start_date}\r\n&checkout=${end_date}&party=%7B\"adults\":2,\"children\":[]%7D&domain=de`;\r\n}\r\n\r\n/*\r\n ** Get Available dates from API.\r\n */\r\nasync function fetchDates(url, target) {\r\n  const btn_text = target.innerText;\r\n  target.innerText = \"loading...\";\r\n\r\n  try {\r\n    const response = await fetch(url);\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n    }\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.log(\"Error: \" + error);\r\n  } finally {\r\n    target.innerText = btn_text;\r\n  }\r\n}\r\n\r\n/*\r\n ** Put Available Dates to the Calendar\r\n */\r\nfunction precessDates(data) {\r\n  let enable_dates = [];\r\n  let enable_dates_obj = {};\r\n  let i = 0;\r\n  for (let item of data._embedded.hotel_availabilities) {\r\n    enable_dates[i] = item.date;\r\n    enable_dates_obj[item.date] = item;\r\n    i++;\r\n  }\r\n\r\n  let showMonthsVar = window.innerWidt > 800 ? 2 : 1;\r\n\r\n  const config = {\r\n    dateFormat: \"Y-m-d\",\r\n    closeOnSelect: false,\r\n    mode: \"range\",\r\n    showMonths: showMonthsVar,\r\n    enable: enable_dates,\r\n    onDayCreate: function (dObj, dStr, fp, dayElem) {\r\n      const formattedDate = new Intl.DateTimeFormat(\"en-CA\").format(\r\n        dayElem.dateObj\r\n      );\r\n\r\n      if (enable_dates_obj[formattedDate]) {\r\n        let day = dayElem.innerHTML;\r\n        dayElem.innerHTML = `\r\n        <span class='day-number'>${day}</span>\r\n          <span class='day-price'>${enable_dates_obj[formattedDate].price}</span>\r\n          `;\r\n      }\r\n    },\r\n\r\n    onOpen: (selectedDates, dateStr, instance) => {\r\n      const calendar_container = instance.calendarContainer;\r\n      const wrapper = document.createElement(\"div\");\r\n      wrapper.id = \"calendar-wrapper\";\r\n      calendar_container.parentNode.insertBefore(wrapper, calendar_container);\r\n      wrapper.appendChild(calendar_container);\r\n      const apply_button = document.createElement(\"button\");\r\n      apply_button.textContent = \"Apply\";\r\n      apply_button.className = \"apply-button btn\";\r\n      calendar_container.appendChild(apply_button);\r\n\r\n      apply_button.addEventListener(\"click\", () => {\r\n        instance.close();\r\n\r\n        let input_dates = instance.input.value;\r\n        let start_date = input_dates.split(\" to \")[0];\r\n        let end_date = input_dates.split(\" to \")[1];\r\n        displayRooms(start_date, end_date);\r\n      });\r\n    },\r\n    onClose: function (selectedDates, dateStr, instance) {\r\n      const calendar_wrapper = document.getElementById(\"calendar-wrapper\");\r\n      calendar_wrapper.remove();\r\n    },\r\n  };\r\n\r\n  let calendar = flatpickr(\"#calendar\", config);\r\n  calendar.open();\r\n}\r\n\r\n/*\r\n ** Create Calendar\r\n */\r\nasync function createCalendar(url, target) {\r\n  const data = await fetchDates(url, target);\r\n  precessDates(data);\r\n}\r\n\r\n/*\r\n ** Get Available Rooms from API for the selected dates\r\n */\r\nasync function fetchRooms(start_date, end_date) {\r\n  const url = quoteeUrl(start_date, end_date);\r\n  const section_rooms = document.getElementById(\"section--rooms\");\r\n  section_rooms.innerHTML = roomCard();\r\n  const message = document.getElementById(\"section--message\");\r\n  const room_card = document.querySelectorAll(\".room-card\");\r\n\r\n  try {\r\n    message.innerHTML = \"\";\r\n\r\n    const response = await fetch(url);\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n    }\r\n\r\n    const hotels = await response.json();\r\n\r\n    return hotels._embedded.hotel_quotes;\r\n  } catch (error) {\r\n    const section_rooms = document.getElementById(\"section--rooms\");\r\n    section_rooms.innerHTML = null;\r\n\r\n    message.innerHTML = `<div class=\"error-message\">\r\n    There are no rooms available for the selected period. Please try another dates.</div>`;\r\n\r\n    console.log(\"Error: \" + error);\r\n  } finally {\r\n    room_card.forEach((element) => {\r\n      element.classList.remove(\"suspense-block\");\r\n    });\r\n  }\r\n}\r\n\r\n/*\r\n ** Display Rooms\r\n */\r\nasync function displayRooms(start_date, end_date) {\r\n  const rooms = await fetchRooms(start_date, end_date);\r\n  const section_rooms = document.getElementById(\"section--rooms\");\r\n  section_rooms.innerHTML = null;\r\n  if (rooms) {\r\n    rooms.map((room, index) => {\r\n      let room_card = roomCard(room, index);\r\n      section_rooms.innerHTML += room_card;\r\n    });\r\n  }\r\n}\r\n\r\n/*\r\n ** Template for Rooms article with suspense effect\r\n */\r\nfunction roomCard(room, index = 0) {\r\n  let suspens_block_classname = \"suspense-block\";\r\n  let suspens_line_classname = \"suspense-line\";\r\n  let description = \"\";\r\n  let img = \"\";\r\n  let amenitie = \"\";\r\n  let price = \"\";\r\n  let nights = \"\";\r\n\r\n  if (room) {\r\n    suspens_block_classname = \"\";\r\n    suspens_line_classname = \"\";\r\n    description = room.description;\r\n    price = room.full_formatted_price;\r\n    nights = room.fullPriceBreakdown.nights;\r\n\r\n    img = `<img src=\"${room._embedded.pictures[0].offer_teaser_ncol}\"\r\n     alt=\"${room._embedded.pictures[0].description}\" loading=\"lazy\" />`;\r\n\r\n    if (room._embedded.amenities) {\r\n      amenitie = room._embedded.amenities.reduce((amenities, item) => {\r\n        return amenities + `<div>${item.description}</div>`;\r\n      }, \"\");\r\n    }\r\n  }\r\n\r\n  return `\r\n    <article id=\"section--rooms--${index}\" class=\"room-card ${suspens_block_classname}\">\r\n                <div class=\"room-card--left\">\r\n                    ${img}\r\n                </div>\r\n                <div class=\"room-card--right\">\r\n                    <div class=\"room-card--body\">\r\n                        <h2 class=\"room-card--header\">${description}</h2>\r\n                        <div class=\"room-card--body--amenities ${suspens_line_classname}\">\r\n                        ${amenitie}\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"room-card--body--price\">\r\n                        <span class=\"room-card--body--price--number ${suspens_line_classname}\">\r\n                          ${price}\r\n                        </span>\r\n                        <span class=\"room-card--body--price--nights ${suspens_line_classname}\">\r\n                          for ${nights} nights\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </article>`;\r\n}\r\n\r\n/*\r\n ** onClick event for the \"Check Availabilities\" button\r\n */\r\nlet btn = document.getElementById(\"check-availabilities--btn\");\r\nbtn.onclick = (event) => createCalendar(CHECKINS_URL, event.target);\r\n"]}